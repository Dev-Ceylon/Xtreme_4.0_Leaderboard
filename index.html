<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LEADERBOARD | SLIIT Xtreme 25</title>
    <link rel="icon" type="image/png" href="https://via.placeholder.com/32">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Montserrat', 'Inter', sans-serif;
        }

        .gradient-bg {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
        }

        .glass-effect {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.15);
        }

        .pulse-animation {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.7;
            }
        }

        .rank-badge-1 {
            background: linear-gradient(135deg, #FFD700, #FFA500);
        }

        .rank-badge-2 {
            background: linear-gradient(135deg, #C0C0C0, #808080);
        }

        .rank-badge-3 {
            background: linear-gradient(135deg, #CD7F32, #8B4513);
        }

        .rank-badge-other {
            background: rgba(255, 255, 255, 0.15);
        }

        .slide-in {
            animation: slideIn 0.6s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .loading-spinner {
            border: 4px solid rgba(255, 255, 255, 0.2);
            border-top: 4px solid white;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .fade-in {
            animation: fadeIn 0.4s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @media (max-width: 768px) {
            .logo-container img {
                height: 60px;
            }

            h1 {
                font-size: 2rem !important;
            }

            .stat-card {
                padding: 1rem !important;
            }

            .stat-value {
                font-size: 1.5rem !important;
            }

            .control-buttons {
                flex-direction: column;
                width: 100%;
            }

            .control-buttons button {
                width: 100%;
            }

            table {
                font-size: 0.875rem;
            }

            .rank-badge-1,
            .rank-badge-2,
            .rank-badge-3,
            .rank-badge-other {
                padding: 0.25rem 0.5rem;
                font-size: 0.75rem;
            }
        }

        @media (max-width: 480px) {
            .logo-container {
                gap: 1rem !important;
            }

            .logo-container img {
                height: 50px;
            }

            h1 {
                font-size: 1.5rem !important;
            }

            .stat-card {
                padding: 0.75rem !important;
            }

            .stat-label {
                font-size: 0.75rem !important;
            }

            .stat-value {
                font-size: 1.25rem !important;
            }

            table td,
            table th {
                padding: 0.5rem !important;
            }

            .team-score {
                font-size: 1rem !important;
            }
        }
    </style>
</head>

<body class="gradient-bg min-h-screen text-white">
    <header class="py-6 md:py-10 px-4">
        <div class="max-w-7xl mx-auto text-center">
            <div class="logo-container flex justify-center items-center gap-4 md:gap-8 flex-wrap mb-4 md:mb-6">
                <img src="images/IEEEXtreme 19.0 logo(colored).png" alt="SLIIT Logo"
                    class="h-16 md:h-20 w-auto object-contain transition-transform hover:scale-110 drop-shadow-lg"
                    onerror="this.style.display='none'">
                <img src="images/CS_White Logo.png" alt="IEEE Logo"
                    class="h-16 md:h-20 w-auto object-contain transition-transform hover:scale-110 drop-shadow-lg"
                    onerror="this.style.display='none'">
                <img src="images/SLIITXtreme_Logo.png" alt="Xtreme Logo"
                    class="h-16 md:h-20 w-auto object-contain transition-transform hover:scale-110 drop-shadow-lg"
                    onerror="this.style.display='none'">
            </div>

            <div class="animate__animated animate__pulse animate__infinite">
                <h1
                    class="text-3xl md:text-5xl lg:text-6xl font-extrabold text-white tracking-widest slide-in drop-shadow-lg">
                    LEADERBOARD
                </h1>
            </div>
            <p class="text-sm md:text-lg text-gray-300 mt-2">SLIIT Xtreme 25 - Competition Rankings</p>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 pb-12">
        <div id="loadingSection" class="glass-effect rounded-2xl p-8 md:p-12 text-center">
            <div class="loading-spinner mx-auto mb-4"></div>
            <p class="text-lg md:text-xl text-gray-200">Loading leaderboard data...</p>
        </div>

        <div id="errorSection" class="hidden glass-effect rounded-2xl p-6 md:p-8 text-center border border-red-500/30">
            <h2 class="text-xl md:text-2xl font-bold text-red-400 mb-3">Unable to Load Data</h2>
            <p class="text-sm md:text-base text-gray-300 mb-5">Failed to fetch leaderboard data from HackerRank API.
                Please check your internet connection.</p>
            <button onclick="location.reload()"
                class="px-6 md:px-8 py-2 md:py-3 bg-white/10 hover:bg-white/20 text-white font-semibold rounded-xl transition-all">
                Retry
            </button>
        </div>

        <div id="statsSection" class="hidden grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4 mb-6 md:mb-10">
            <div class="stat-card glass-effect rounded-xl p-4 md:p-6 text-center">
                <p class="stat-label text-gray-300 text-xs md:text-sm uppercase">Total Teams</p>
                <p id="totalParticipants" class="stat-value text-2xl md:text-3xl font-bold mt-2">0</p>
            </div>
            <div class="stat-card glass-effect rounded-xl p-4 md:p-6 text-center">
                <p class="stat-label text-gray-300 text-xs md:text-sm uppercase">Top Score</p>
                <p id="topScore" class="stat-value text-2xl md:text-3xl font-bold mt-2">0</p>
            </div>
            <div class="stat-card glass-effect rounded-xl p-4 md:p-6 text-center">
                <p class="stat-label text-gray-300 text-xs md:text-sm uppercase">Average Score</p>
                <p id="avgScore" class="stat-value text-2xl md:text-3xl font-bold mt-2">0</p>
            </div>
            <div class="stat-card glass-effect rounded-xl p-4 md:p-6 text-center">
                <p class="stat-label text-gray-300 text-xs md:text-sm uppercase">Best Time</p>
                <p id="bestTime" class="stat-value text-lg md:text-2xl font-semibold mt-2">--</p>
            </div>
        </div>

        <div id="controlsSection" class="hidden glass-effect rounded-xl p-4 md:p-6 mb-6 md:mb-8">
            <div class="flex flex-col gap-3 md:gap-4">
                <input id="searchInput" type="text" placeholder="Search by team name..."
                    class="w-full px-3 md:px-4 py-2 md:py-3 bg-white/10 placeholder-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-white/40 text-white text-sm md:text-base">
                <div class="control-buttons flex flex-col md:flex-row gap-2">
                    <button onclick="sortBy('rank')"
                        class="px-4 md:px-6 py-2 md:py-3 bg-white/10 hover:bg-white/20 rounded-lg transition-all text-sm md:text-base">By
                        Rank</button>
                    <button onclick="sortBy('score')"
                        class="px-4 md:px-6 py-2 md:py-3 bg-white/10 hover:bg-white/20 rounded-lg transition-all text-sm md:text-base">By
                        Score</button>
                    <button onclick="resetData()"
                        class="px-4 md:px-6 py-2 md:py-3 bg-white/10 hover:bg-white/20 rounded-lg transition-all text-sm md:text-base">Reset</button>
                </div>
            </div>
            <p id="filterInfo" class="text-xs md:text-sm text-gray-300 mt-3"></p>
        </div>

        <div id="leaderboardSection" class="hidden glass-effect rounded-xl md:rounded-2xl overflow-hidden">
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead>
                        <tr class="bg-white/10 border-b border-white/20">
                            <th
                                class="px-2 md:px-4 py-3 md:py-4 text-left text-xs uppercase text-gray-300 tracking-wider">
                                Rank</th>
                            <th
                                class="px-2 md:px-4 py-3 md:py-4 text-left text-xs uppercase text-gray-300 tracking-wider">
                                Team</th>
                            <th
                                class="px-2 md:px-4 py-3 md:py-4 text-center text-xs uppercase text-gray-300 tracking-wider">
                                Score</th>
                        </tr>
                    </thead>
                    <tbody id="leaderboardBody" class="divide-y divide-white/10">
                    </tbody>
                </table>
            </div>
        </div>

        <div id="paginationSection" class="hidden mt-6 flex flex-col md:flex-row justify-between items-center gap-4">
            <p id="paginationInfo" class="text-gray-200 text-sm md:text-base text-center"></p>
            <div class="flex gap-2">
                <button id="prevBtn" onclick="prevPage()"
                    class="px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg transition-all disabled:opacity-40 text-sm md:text-base">Previous</button>
                <button id="nextBtn" onclick="nextPage()"
                    class="px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg transition-all disabled:opacity-40 text-sm md:text-base">Next</button>
            </div>
        </div>
    </main>

    <footer class="text-center py-6 md:py-8 text-gray-400 text-xs md:text-sm">
        &copy; 2025 SLIIT Xtreme 25. All rights reserved.
    </footer>

    <script>
        let leaderboardData = [];
        let filteredData = [];
        let currentPage = 1;
        const itemsPerPage = 50;

        document.addEventListener('DOMContentLoaded', loadLeaderboardData);

        async function loadLeaderboardData() {
            try {
                // Using CORS proxy to bypass CORS restrictions
                const apiUrl = 'https://www.hackerrank.com/rest/contests/sliitxtreme-4-final/leaderboard?offset=0&limit=100';
                const proxyUrl = 'https://api.allorigins.win/raw?url=';

                const response = await fetch(proxyUrl + encodeURIComponent(apiUrl));
                if (!response.ok) throw new Error('Failed to fetch leaderboard data');

                const data = await response.json();
                parseLeaderboardData(data);
            } catch (error) {
                console.error('Error loading leaderboard:', error);
                document.getElementById('loadingSection').classList.add('hidden');
                document.getElementById('errorSection').classList.remove('hidden');

                // Show more detailed error message
                const errorMsg = document.querySelector('#errorSection p');
                errorMsg.textContent = `Error: ${error.message}. Please try again later or check your internet connection.`;
            }
        }

        function parseLeaderboardData(data) {
            leaderboardData = [];

            if (!data.models || !Array.isArray(data.models)) {
                throw new Error('Invalid data format');
            }

            data.models.forEach((item, index) => {
                const teamData = {
                    rank: item.rank || (index + 1),
                    hacker: item.hacker || 'Unknown Team',
                    score: item.score || 0,
                    time_taken: item.time_taken || 0,
                    country: item.country || '',
                    school: item.school || '',
                    avatar: item.avatar || 'https://d1ce3iv5vajdy.cloudfront.net/hackerrank/assets/gravatar.jpg'
                };
                leaderboardData.push(teamData);
            });

            console.log(`Loaded ${leaderboardData.length} teams from API`);

            filteredData = [...leaderboardData];

            setTimeout(() => {
                document.getElementById('loadingSection').classList.add('hidden');
                displayLeaderboard();
                updateStatistics();
                showControls();
            }, 500);
        }

        function displayLeaderboard() {
            const tbody = document.getElementById('leaderboardBody');
            tbody.innerHTML = '';
            const start = (currentPage - 1) * itemsPerPage;
            const pageData = filteredData.slice(start, start + itemsPerPage);

            pageData.forEach(p => tbody.appendChild(createRow(p)));

            document.getElementById('leaderboardSection').classList.remove('hidden');
            updatePagination();
        }

        function createRow(p) {
            const tr = document.createElement('tr');
            tr.className = 'hover:bg-white/5 transition-all fade-in';
            const rank = parseInt(p.rank);
            let badge = 'rank-badge-other';
            if (rank === 1) badge = 'rank-badge-1';
            else if (rank === 2) badge = 'rank-badge-2';
            else if (rank === 3) badge = 'rank-badge-3';

            const teamName = p.hacker || p['Team Name'] || 'N/A';
            const score = p.score || 0;
            const time = formatTime(p.time_taken);

            tr.innerHTML = `
                <td class="px-2 md:px-4 py-3 md:py-4"><span class="${badge} px-2 md:px-3 py-1 rounded-full text-xs md:text-sm font-bold">#${p.rank}</span></td>
                <td class="px-2 md:px-4 py-3 md:py-4 font-semibold text-sm md:text-base">${teamName}</td>
                <td class="px-2 md:px-4 py-3 md:py-4 text-center text-lg md:text-xl font-bold text-green-400 team-score">${score}</td>
            `;
            return tr;
        }

        function formatTime(s) {
            if (!s || s === '0') return '--';
            const sec = parseInt(s);
            if (isNaN(sec)) return '--';
            const h = Math.floor(sec / 3600);
            const m = Math.floor((sec % 3600) / 60);
            const secs = sec % 60;
            return `${h}h ${m}m ${secs}s`;
        }

        function updateStatistics() {
            const total = leaderboardData.length;
            document.getElementById('totalParticipants').textContent = total;

            if (total === 0) return;

            const topScore = Math.max(...leaderboardData.map(p => parseFloat(p.score) || 0));
            const avgScore = (leaderboardData.reduce((a, p) => a + (parseFloat(p.score) || 0), 0) / total).toFixed(2);
            const times = leaderboardData.map(p => parseInt(p.time_taken) || 0).filter(x => x > 0);
            const bestTime = times.length ? Math.min(...times) : 0;

            document.getElementById('topScore').textContent = topScore;
            document.getElementById('avgScore').textContent = avgScore;
            document.getElementById('bestTime').textContent = formatTime(bestTime);
            document.getElementById('statsSection').classList.remove('hidden');
        }

        function showControls() {
            document.getElementById('controlsSection').classList.remove('hidden');
            document.getElementById('paginationSection').classList.remove('hidden');
            document.getElementById('searchInput').addEventListener('input', e => searchParticipants(e.target.value));
        }

        function searchParticipants(q) {
            q = q.trim().toLowerCase();
            filteredData = q
                ? leaderboardData.filter(p =>
                    (p.hacker || '').toLowerCase().includes(q) ||
                    (p['Team Name'] || '').toLowerCase().includes(q) ||
                    (p.country || '').toLowerCase().includes(q)
                )
                : [...leaderboardData];
            currentPage = 1;
            displayLeaderboard();
            document.getElementById('filterInfo').textContent = q
                ? `Showing ${filteredData.length} of ${leaderboardData.length} teams`
                : '';
        }

        function sortBy(f) {
            if (f === 'rank') {
                filteredData.sort((a, b) => parseInt(a.rank) - parseInt(b.rank));
            } else if (f === 'score') {
                filteredData.sort((a, b) => parseFloat(b.score) - parseFloat(a.score));
            }
            currentPage = 1;
            displayLeaderboard();
        }

        function updatePagination() {
            const totalPages = Math.ceil(filteredData.length / itemsPerPage);
            const start = (currentPage - 1) * itemsPerPage + 1;
            const end = Math.min(currentPage * itemsPerPage, filteredData.length);
            document.getElementById('paginationInfo').textContent = `Showing ${start}-${end} of ${filteredData.length} teams`;
            document.getElementById('prevBtn').disabled = currentPage === 1;
            document.getElementById('nextBtn').disabled = currentPage >= totalPages;
        }

        function prevPage() {
            if (currentPage > 1) {
                currentPage--;
                displayLeaderboard();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function nextPage() {
            const totalPages = Math.ceil(filteredData.length / itemsPerPage);
            if (currentPage < totalPages) {
                currentPage++;
                displayLeaderboard();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function resetData() {
            filteredData = [...leaderboardData];
            currentPage = 1;
            document.getElementById('searchInput').value = '';
            document.getElementById('filterInfo').textContent = '';
            displayLeaderboard();
        }
    </script>
</body>

</html>